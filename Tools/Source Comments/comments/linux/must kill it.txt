 I hate this code so much. Must kill it