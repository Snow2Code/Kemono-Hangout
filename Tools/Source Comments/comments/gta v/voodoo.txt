 This is voodoo, and sucks. I'm open for suggestions for a better approach.